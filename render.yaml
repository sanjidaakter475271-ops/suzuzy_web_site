# Render.com Blueprint Configuration
# This file defines all services for Royal Suzuky deployment
# https://render.com/docs/blueprint-spec

services:
  # ============================================
  # Portal App (Admin/Dealer Dashboard)
  # ============================================
  - type: web
    name: royal-suzuky-portal
    runtime: docker
    dockerfilePath: ./apps/portal/Dockerfile
    dockerContext: ./apps/portal
    region: singapore
    plan: free
    branch: main
    buildFilter:
      paths:
        - apps/portal/**
    envVars:
      - key: NEXT_PUBLIC_SUPABASE_URL
        sync: false
      - key: NEXT_PUBLIC_SUPABASE_ANON_KEY
        sync: false
      - key: NEXT_PUBLIC_REALTIME_URL
        fromService:
          name: royal-suzuky-realtime
          type: web
          property: host
      - key: NODE_ENV
        value: production
      - key: DATABASE_URL
        sync: false
      - key: DIRECT_URL
        sync: false
      - key: BETTER_AUTH_SECRET
        sync: false
      - key: BETTER_AUTH_URL
        sync: false

  # ============================================
  # Realtime Server (Socket.io)
  # ============================================
  - type: web
    name: royal-suzuky-realtime
    runtime: docker
    dockerfilePath: ./apps/realtime/Dockerfile
    dockerContext: ./apps/realtime
    region: singapore
    plan: free
    branch: main
    buildFilter:
      paths:
        - apps/realtime/**
    envVars:
      - key: NODE_ENV
        value: production
      - key: CORS_ORIGIN
        fromService:
          name: royal-suzuky-portal
          type: web
          property: host

  # ============================================
  # Storefront App (Public Website)
  # ============================================
  - type: web
    name: royal-suzuky-storefront
    runtime: docker
    dockerfilePath: ./apps/storefront/Dockerfile
    dockerContext: ./apps/storefront
    region: singapore
    plan: free
    branch: main
    buildFilter:
      paths:
        - apps/storefront/**
    envVars:
      - key: NEXT_PUBLIC_SUPABASE_URL
        sync: false
      - key: NEXT_PUBLIC_SUPABASE_ANON_KEY
        sync: false
      - key: NODE_ENV
        value: production

